---
title: Build a custom email/password authentication flow
description: Learn how to build a custom email/password sign-up and sign-in flow using Clerk's useSignUp() and useSignIn() hooks.
---

# Build a custom email/password authentication flow

<Callout type="danger">
  This guide is for users who want to build a *custom* user interface using the Clerk API. To authenticate users with email and password using a *prebuilt* UI, you should use Clerk's [Account Portal pages](/docs/account-portal/overview) or [prebuilt components](/docs/components/overview).
</Callout>

Clerk supports password authentication, which allows users to sign up and sign in using their email address and password. This guide will walk you through how to build a custom email/password sign-up and sign-in flow using the [`useSignUp()`](/docs/references/react/use-sign-up) and [`useSignIn()`](/docs/references/react/use-sign-up) hooks.

<Steps>

### Enable email and password authentication

To use email and password authentication, you first need to enable these authentication strategies in the Clerk Dashboard. 

1. Navigate to the Clerk Dashboard.
2. Go to **User & Authentication > [Email, Phone, and Username](https://dashboard.clerk.com/last-active?path=user-authentication/email-phone-username)** in the sidebar menu. 
3. Toggle on **Email address** and **Password**.

By default, the email address verification method is set to **Email code**. This means that when a user signs up using their email address and password, Clerk will send a one-time code to the user's email address. The user must then enter this code to verify their email and complete the sign-up process. For the sake of this guide, the default method, **Email code**, will be used.

### Create the email/password sign-up flow

To sign up a user using their email and password, you need to:

1. Initiate the sign-up process by collecting the user's email address and password.
2. Prepare the email address verification, which sends a one-time code to the given address.
3. Attempt to complete the email address verification by supplying the one-time code.
4. If the email address verification is successful, complete the sign-up process by creating the user account and setting their session as active.

In the following example, the user is prompted to enter their email address and password. The user's email address and password are then used to initiate the sign-up process. If the sign-up process is successful, the user is prompted to enter a one-time code sent to their email address. If the email address verification is successful, the user's session is set as active.

<Tabs type="framework" items={["Next.js","JavaScript"]}>
  <Tab>
    For the sake of this guide, this example is written for Next.js App Router but it is supported by any React meta framework, such as Remix or Gatsby.

    ```tsx filename="app/sign-up/[[...sign-up]]/page.tsx
    'use client'

    import * as React from 'react';
    import { useSignUp } from '@clerk/nextjs';
    import { useRouter } from 'next/navigation';

    export default function Page() {
      const { isLoaded, signUp, setActive } = useSignUp();
      const [emailAddress, setEmailAddress] = React.useState("");
      const [password, setPassword] = React.useState("");
      const [verifying, setVerifying] = React.useState(false);
      const [code, setCode] = React.useState("");
      const router = useRouter();

      // This function will handle the user submitting their email and password
      const handleSubmit = async (e: React.FormEvent) => {
        e.preventDefault();
        if (!isLoaded) return;
        
        // Start the sign-up process using the email and password provided
        try {
          await signUp.create({
            emailAddress, password
          });

          // Send the user an email with the verification code
          await signUp.prepareEmailAddressVerification({
            strategy: 'email_code'
          });

          // Set 'verifying' true to display second form and capture the OTP code
          setVerifying(true);
        }
        catch (err: any) {
          // This can return an array of errors.
          // See https://clerk.com/docs/custom-flows/error-handling to learn about error handling
          console.error('Error:', JSON.stringify(err, null, 2));
        }
      }

      // This function will handle the user submitting a code for verification
      const handleVerify = async (e: React.FormEvent) => {
        e.preventDefault();
        if (!isLoaded) return;

        try {
          // Submit the code that the user provides to attempt verification
          const completeSignUp = await signUp.attemptEmailAddressVerification({
            code
          });

          if (completeSignUp.status !== "complete") {
            // The status can also be `abandoned` or `missing_requirements`
            // Please see https://clerk.com/docs/references/react/use-sign-up#result-status for  more information
            console.log(JSON.stringify(completeSignUp, null, 2));
          }

          // Check the status to see if it is complete
          // If complete, the user has been created -- set the session active
          if (completeSignUp.status === "complete") {
            await setActive({ session: completeSignUp.createdSessionId });
            // Redirect the user to a post sign-up route
            router.push("/");
          }
        }
        catch (err: any) {
          // This can return an array of errors.
          // See https://clerk.com/docs/custom-flows/error-handling to learn about error handling
          console.error('Error:', JSON.stringify(err, null, 2));
        }
      }

      // Once the sign-up form was submitted, verifying was set to true and as a result, this verification form is presented to the user to input their verification code.
      if (verifying) {
        return (
          <form onSubmit={handleVerify}>
            <label id="code">Code</label>
            <input value={code} id="code" name="code" onChange={(e) => setCode(e.target.value)} />
            <button type="submit">Complete Sign Up</button>
          </form>
        )
      }
      
      // Display the initial sign-up form to capture the email and password
      return (
        <form onSubmit={handleSubmit}>
          <div>
            <label htmlFor="email">Email address</label>
            <input id="email" type='email' name="email" value={emailAddress} onChange={(e) => setEmailAddress(e.target.value)} />
          </div>
          <div>
            <label className="block text-sm mt-8" htmlFor="password">Password</label>
            <input id="password" type='password' name="password" value={password} onChange={(e) => setPassword(e.target.value)} />
          </div>
          <div>
            <button type="submit">Verify Email</button>
          </div>
        </form>
      );
    }
    ```
    </Tab>

    {/* TODO (Roy): Use CodeBlockTabs and add example for NPM Module vs window.Clerk (Script) - see the /docs/components/user-button update I did in this PR */}
    <Tab>
  ```html filename="your-app.html"
  <!DOCTYPE html>
  <html lang="en">

  <head>
      <meta charset="UTF-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Clerk JavaScript Email + Password</title>
  </head>

  <body>
      <h1>Clerk JavaScript Email + Password</h1>

      <div id="auth-signup">
          <input placeholder="email" id="email" type="email"></input>
          <input placeholder="password" id="password" type="password"></input>
          <button onclick="SignUp()">SignUp</button>

      </div>
      <div id="auth-verification" hidden="true">
          <input placeholder="code" id="code" type="text"></input>
          <button onclick="VerifyEmailAddress()">Verify</button>
      </div>

      <div id="user-button" />
      <script>
          const SignUp = async () => {
              const emailAddress = document.getElementById('email').value;
              const password = document.getElementById('password').value;
              const {client} = window.Clerk;
              try {
                  await client.signUp.create({
                      emailAddress,
                      password
                  });
                  await client.signUp.prepareEmailAddressVerification();
                  //hide signup form
                  document.getElementById('auth-signup').hidden = true;
                  //show verification form
                  document.getElementById('auth-verification').hidden = false;
              }
              catch (err) {
                  console.log(err)
              }
          };
          const VerifyEmailAddress = async () => {
              const code = document.getElementById('code').value;
              const {client, setActive} = window.Clerk;
              try {
                  // Verify the email address.
                  const verify = await client.signUp.attemptEmailAddressVerification({
                      code
                  });
                  // User is created. Now, set the session to active. session is never null.
                  await setActive({session: verify.createdSessionId})
              }

              catch (err) {
                  console.log(err)
              }
          }
      </script>
      // Script to load Clerk up
      <script src="src/script.js" async crossorigin="anonymous"></script>
  </body>

  </html>
  ```
  </Tab>
</Tabs>

### Create the email/password sign-in flow

To authenticate a user using their email and password, you need to:

1. Initiate the sign-in process by collecting the user's authentication identifier.
2. Prepare the first factor verification.
3. Attempt to complete the first factor verification.
4. If the verification is successful, set the newly created session as active.

In the following example, the user is prompted to enter their email address and password. The user's email address and password are then used to initiate the sign-in process. If the sign-in process is successful, the user's session is set as active.

<Tabs type="framework" items={["Next.js", "JavaScript"]}>
  <Tab>
    For the sake of this guide, this example is written for Next.js App Router but it is supported by any React meta framework, such as Remix or Gatsby.

    ```tsx  filename="app/sign-in/[[...sign-in]].page.tsx"
    'use client'

    import * as React from "react";
    import { useSignIn } from "@clerk/nextjs";
    import { useRouter } from "next/navigation";

    export default function SignInForm() {
      const { isLoaded, signIn, setActive } = useSignIn();
      const [email, setEmail] = React.useState("");
      const [password, setPassword] = React.useState("");
      const router = useRouter();

      // Handle the submission of the sign-in form
      const handleSubmit = async (e: React.FormEvent) => {
        e.preventDefault();
        if (!isLoaded) {
          return;
        }

        // Start the sign-in process using the email and password provided
        try {
          const completeSignIn = await signIn.create({
            identifier: email,
            password,
          });

          if (completeSignIn.status !== 'complete') {
            // The status can also be `needs_factor_one', 'needs_factor_two', or 'needs_identifier'
            // Please see https://clerk.com/docs/references/javascript/sign-in/sign-in for more information
            console.log(JSON.stringify(completeSignIn, null, 2));
          }

          if (completeSignIn.status === 'complete') {
            // If complete, user exists and provided password match -- set session active
            await setActive({ session: completeSignIn.createdSessionId });
            // Redirect the user to a post sign-in route
            router.push('/');
          }
        } catch (err: any) {
          // This can return an array of errors.
          // See https://clerk.com/docs/custom-flows/error-handling to learn about error handling
          console.error(JSON.stringify(err, null, 2));
        }
      };

      // Display a form to capture the user's email and password
      return (
        <div>
          <form onSubmit={(e) => handleSubmit(e)}>
            <div>
              <label htmlFor="email">Email</label>
              <input onChange={(e) => setEmail(e.target.value)} id="email" name="email" type="email" value={email} />
            </div>
            <div>
              <label htmlFor="password">Password</label>
              <input onChange={(e) => setPassword(e.target.value)} id="password" name="password" type="password" value={password} />
            </div>
            <button type="submit">Sign In</button>
          </form>
        </div>
      );
    }
    ```
  </Tab>

{/* TODO (Roy): Use CodeBlockTabs and add example for NPM Module vs window.Clerk (Script) - see the /docs/components/user-button update I did in this PR */}
  <Tab>
  ```html filename="your-app.html"
  <!DOCTYPE html>
  <html lang="en">

  <head>
      <meta charset="UTF-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Clerk JavaScript Email + Password</title>
  </head>

  <body>
      <h1>Clerk JavaScript Email + Password</h1>

      <div id="auth-signin">
          <input placeholder="email" id="email" type="email"></input>
          <input placeholder="password" id="password" type="password"></input>
          <button onclick="SignIn()">SignIn</button>

      </div>
      <script>
          const SignIn = async () => {
              const emailAddress = document.getElementById('email').value;
              const password = document.getElementById('password').value;
              const {client} = window.Clerk;
              try {
                const signInAttempt = await client.signIn.create({
                      emailAddress,
                      password
                  });
                if (signInAttempt.status === "complete") {
                  await setActive({ session: signInAttempt.createdSessionId });
                  // Add logic to redirect the user how you see fit.
                }
                else {
                  /* Investigate why the login hasn't completed */
                  console.log(signInAttempt);
                }
              }
              catch (err) {
                  console.log(err)
              }
          };
      </script>
      // Script to load Clerk up
      <script src="src/script.js" async crossorigin="anonymous"></script>
  </body>

  </html>
  ```
  </Tab>
</Tabs>
</Steps>
